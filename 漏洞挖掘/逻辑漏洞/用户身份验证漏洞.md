# 用户身份验证漏洞

## 密码重置

### 场景一

重置密码时，选择自己的手机号码接收短信

系统会将你的手机号码设置在form表单上

然后将form表单上的手机号码修改为别人的手机号码

用自己手机号码收到的短信，重置密码，结果成功重置别人的密码

### 场景二

重置密码时，填写别人的邮箱后

然后页面有个按钮，重新发送邮件

抓包，将其中的邮箱地址改为自己的

进入到自己的邮箱中，点击链接，结果成功修改别人的密码

### 场景三

重置密码时，验证码显示在返回包里

### 场景四

获取到的验证码过于简单，且没有验证限制，可以尝试爆破

## 登录

### 弱口令

使用了默认的密码或者密码可爆破

推荐两个社会工程学密码生成器

    https://github.com/Mebus/cupp
    https://github.com/zgjx6/SocialEngineeringDictionaryGenerator

### Cookie可伪造

举例

    Cookie: userid=xxx
    
有些Cookie是加密的

flask_unsign模块的作用是字典爆破加密的Cookie的密钥
    
### 场景一

登录失败后，通过修改返回包，比如false改为true、0改为1等，从而成功进入系统；当存在这种漏洞时，一般都存在未授权访问接口

### 场景二

后端没有校验密码为必填，通过抓包，将密码置空或将参数删除，从而登录系统

### 场景三

直接访问/admin 会302跳转

使用/xxx/..;/admin/ 绕过目录限制

## 注册

### 场景一

页面没有注册功能，但找到隐藏的注册接口，进行注册

### 场景二

后端没有校验验证码为必填，通过抓包将验证码置空或将参数删除，从而进行注册

### 场景三

注册时，验证码显示在返回包中

### 场景四

获取到的验证码过于简单，且没有验证限制，可以尝试爆破

